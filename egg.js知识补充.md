###### egg.js知识补充

1. 中间件的定位是拦截用户请求，并在它前后做一些事情，例如：鉴权、安全检查、访问日志等等。中间件加载其实是有先后顺序的，但是中间件自身却无法管理这种顺序，只能交给使用者。这样其实非常不友好，一旦顺序不对，结果可能有天壤之别。

2. 插件：插件就是一个迷你的应用，它包含了Service、中间件、配置、框架扩展等；它没有独立的Router和Controller；它只能声明跟其他插件的依赖，不能决定其他插件的开启与否。

   - 插件的使用：通过npm模块进行复用

     ```
     npm i egg-mysql --save
     ```

   - 在应用和框架中声明

     ```
     exports.mysql = {
     	enable: true,
     	package: 'egg-mysql',
     };
     ```

   - 参数介绍：

     - {Boolean} enable : 是否开启此插件，默认为 true
     - {String} package :npm模块名称，通过 npm 模块形式引入插件
     - {String} path :插件绝对路径，跟 package 配置互斥
     - {Array} env : 只有在指定运行环境才能开启，会覆盖插件自身 package.json 中的配置

3. 定时任务：所有的定时任务都统一存放在 app/schedule目录下，每一个文件都是一个独立的定时任务，可以配置定时任务的属性和要执行的方法。定时的两种方法：

   - interval :定时任务将会每间隔指定的时间执行一次。有两种配置类型：

     - 数字类型：单位为毫秒数，列如 5000
     - 字符类型：会通过单位转换为毫秒数，列如 5s。

     ```
     module.exports = {
     	schedule: {
     		//每5秒执行一次
     		interval: '5s', //等价于 interval: 5000,
     	},
     };
     ```

     

   - cron :定时任务将会按照 cron 表达式在特定的时间点执行。下面是参数的说明：

     ```
     *    *    *    *    *    *
     ┬    ┬    ┬    ┬    ┬    ┬
     │    │    │    │    │    |
     │    │    │    │    │    └ day of week (0 - 7) (0 or 7 is Sun)
     │    │    │    │    └───── month (1 - 12)
     │    │    │    └────────── day of month (1 - 31)
     │    │    └─────────────── hour (0 - 23)
     │    └──────────────────── minute (0 - 59)
     └───────────────────────── second (0 - 59, optional)
     ```

     ```
     module.exports = {
     	schedule: {
     		//没三小时执行一次
     		cron: '0 0 */3 * * *'
     	},
     };
     ```



###### Spring Cloud学习笔记1

1. 单体应用面临的问题：复杂性高，技术债务，部署频率低，可靠性差，扩张能力受限，阻碍技术创新。微服务框架：一种将一个单体应用程序开发为一组小行服务的方法，每个服务运行在自己的进程中，服务间通信采用轻量级通信机制（通常用 HTTP 资源  API）。这些服务围绕业务能力构建摒弃人可通过全自动部署机制独立部署。这些服务共用一个最小型的集中式的管理，服务可用不同的语言开发，使用不同的数据存储技术。微服务的特性：

   - 每个微服务可独立运行在自己的进程里，做到了进程隔离
   - 每个服务为独立的业务开发，一个微服务只关注某个特定的功能，例如订单管理、用户管理等
   - 微服务之间通过一些轻量级的通信机制进行通信，例如通过 RESTful API 进行调用
   - 可以使用不同的语言与数据库存储技术

   微服务的不足：

   - 运维要求高
   - 分布式系统的复杂性
   - 重复劳动

   微服务的设计原则：

   - 单一职责原则
   - 服务自治原则
   - 轻量级通信原则
   - 接口明确原则

2. spring cloud是一个用于构建分布式系统的通用模块的工具集，spring cloud的特点：

   - 隐藏了组件的复杂性
   - 轻量级的组件，组件丰富
   - 灵活，spring cloud的组成是解耦的

